<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BÌåÄ ÏóîÌä∏Î¶¨ Íµ¨ÏÑ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 8px;
            font-size: 1.8rem;
            color: #feca57;
        }
        
        .round-selector {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .round-selector label {
            font-size: 1rem;
            color: #aaa;
        }
        
        .round-selector input {
            width: 80px;
            padding: 8px 12px;
            border: 2px solid #feca57;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .round-selector select {
            padding: 8px 12px;
            border: 2px solid #feca57;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
            cursor: pointer;
        }
        
        .round-selector select option {
            background: #1a1a2e;
            color: #fff;
        }
        
        .uniform-selector {
            display: flex;
            gap: 8px;
            margin-left: 5px;
        }
        
        .uniform-btn {
            width: 40px;
            height: 40px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            transition: all 0.2s ease;
        }
        
        .uniform-btn.white {
            background: #ffffff;
            color: #333;
        }
        
        .uniform-btn.red {
            background: #e74c3c;
            color: #fff;
        }
        
        .uniform-btn.black {
            background: #2c3e50;
            color: #fff;
        }
        
        .uniform-btn:hover {
            transform: scale(1.1);
        }
        
        .uniform-btn.selected {
            border-color: #feca57;
            box-shadow: 0 0 10px rgba(254, 202, 87, 0.5);
            transform: scale(1.1);
        }
        
        .uniform-btn .uniform-icon {
            filter: drop-shadow(1px 1px 1px rgba(0,0,0,0.3));
        }
        
        .match-order-info {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .match-slot {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            min-width: 120px;
        }
        
        .match-slot.current {
            background: rgba(254, 202, 87, 0.2);
            border: 2px solid #feca57;
        }
        
        .match-slot .slot-label {
            font-size: 0.75rem;
            color: #888;
            margin-bottom: 5px;
        }
        
        .match-slot .slot-teams {
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .match-slot .slot-quarters {
            font-size: 0.7rem;
            color: #aaa;
            margin-top: 3px;
        }
        
        .b-highlight {
            color: #feca57;
        }
        
        .stamina-warning {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: #ff6b6b;
        }
        
        .stamina-ok {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }
        
        /* Ïö¥ÏòÅÏßÑ ÏÑπÏÖò */
        .staff-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
            border-top: 4px solid #9b59b6;
        }
        
        .staff-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #9b59b6;
            margin-bottom: 15px;
        }
        
        .staff-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        @media (max-width: 800px) {
            .staff-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .staff-category {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 12px;
        }
        
        .staff-category-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #aaa;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .staff-slots {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .staff-slot {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border: 2px dashed rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }
        
        .staff-slot.drag-over {
            background: rgba(155, 89, 182, 0.2);
            border-color: #9b59b6;
        }
        
        .staff-slot.filled {
            border-style: solid;
            border-color: #9b59b6;
            background: rgba(155, 89, 182, 0.1);
        }
        
        .staff-slot .slot-role {
            min-width: 60px;
            font-size: 0.8rem;
            color: #888;
        }
        
        .staff-slot .slot-player {
            flex: 1;
            font-weight: 600;
            color: #fff;
        }
        
        .staff-slot .slot-player.empty {
            color: #555;
        }
        
        .staff-slot .remove-staff {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 107, 107, 0.2);
            border-radius: 50%;
            color: #ff6b6b;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
            font-size: 0.8rem;
        }
        
        .staff-slot:hover .remove-staff {
            opacity: 1;
        }
        
        .staff-slot .remove-staff:hover {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 25px;
        }
        
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }
        
        /* ÏÑ†Ïàò Ìå®ÎÑê */
        .player-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            border-top: 4px solid #feca57;
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        
        .panel-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #feca57;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .attendance-count {
            font-size: 0.85rem;
            background: rgba(254, 202, 87, 0.2);
            padding: 4px 10px;
            border-radius: 12px;
        }
        
        .player-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .player-chip {
            display: flex;
            align-items: center;
            padding: 12px 14px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            cursor: grab;
            transition: all 0.2s ease;
            border: 2px solid transparent;
            user-select: none;
        }
        
        .player-chip:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .player-chip.selected {
            background: rgba(76, 175, 80, 0.2);
            border-color: #4caf50;
        }
        
        .player-chip.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        
        .player-chip .number {
            width: 36px;
            height: 36px;
            background: rgba(254, 202, 87, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.95rem;
            margin-right: 12px;
            color: #feca57;
        }
        
        .player-chip .info {
            flex: 1;
        }
        
        .player-chip .name {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 2px;
        }
        
        .player-chip .position {
            font-size: 0.75rem;
            color: #888;
        }
        
        .player-chip .quarter-count {
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 8px;
        }
        
        .player-chip .quarter-count.high {
            background: rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }
        
        .player-chip .quarter-count.medium {
            background: rgba(254, 202, 87, 0.3);
            color: #feca57;
        }
        
        .player-chip .quarter-count.low {
            background: rgba(255, 107, 107, 0.3);
            color: #ff6b6b;
        }
        
        .player-chip .check {
            color: #4caf50;
            font-size: 1.3rem;
            opacity: 0;
            margin-left: 8px;
        }
        
        .player-chip.selected .check {
            opacity: 1;
        }
        
        .position-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 4px;
        }
        
        .position-badge.pg { background: #e74c3c; }
        .position-badge.sg { background: #e67e22; }
        .position-badge.fw { background: #27ae60; }
        .position-badge.c { background: #3498db; }
        
        /* ÏóîÌä∏Î¶¨ ÏòÅÏó≠ */
        .entry-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .action-bar {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .action-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .action-btn.primary {
            background: #feca57;
            color: #1a1a2e;
        }
        
        .action-btn.primary:hover {
            background: #fed87a;
            transform: translateY(-2px);
        }
        
        .action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .action-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .action-btn.success {
            background: #4caf50;
            color: #fff;
        }
        
        .action-btn.success:hover {
            background: #5cbf60;
        }
        
        /* ÏóîÌä∏Î¶¨ Ïπ¥Îìú - ÏÑ∏Î°ú Î∞∞Ïπò */
        .entry-cards {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .entry-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 24px;
            border-left: 5px solid;
        }
        
        .entry-card.vs-a {
            border-left-color: #ff6b6b;
        }
        
        .entry-card.vs-c {
            border-left-color: #48dbfb;
        }
        
        .entry-card-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .entry-card.vs-a .entry-card-title {
            color: #ff6b6b;
        }
        
        .entry-card.vs-c .entry-card-title {
            color: #48dbfb;
        }
        
        /* ÏøºÌÑ∞ - Í∞ÄÎ°ú Î∞∞Ïπò */
        .quarters-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .quarter-row {
            display: flex;
            align-items: stretch;
            gap: 15px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            padding: 15px;
        }
        
        .quarter-label {
            min-width: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
            color: #feca57;
            background: rgba(254, 202, 87, 0.1);
            border-radius: 8px;
            padding: 10px;
        }
        
        .quarter-players {
            flex: 1;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            min-height: 60px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border: 2px dashed rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }
        
        .quarter-players.drag-over {
            background: rgba(254, 202, 87, 0.1);
            border-color: #feca57;
        }
        
        .quarter-players.full {
            border-color: #4caf50;
            border-style: solid;
        }
        
        .quarter-players.over {
            border-color: #ff6b6b;
        }
        
        /* ÏóîÌä∏Î¶¨ ÏÑ†Ïàò Ïπ¥Îìú - Í∞ÄÎèÖÏÑ± Ìñ•ÏÉÅ */
        .entry-player {
            display: flex;
            align-items: center;
            padding: 10px 14px;
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 100%);
            border-radius: 10px;
            cursor: grab;
            transition: all 0.2s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-width: 140px;
        }
        
        .entry-player:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .entry-player.dragging {
            opacity: 0.5;
        }
        
        .entry-player .num {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #feca57 0%, #f39c12 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.1rem;
            color: #1a1a2e;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .entry-player .player-details {
            flex: 1;
        }
        
        .entry-player .player-name {
            font-weight: 600;
            font-size: 1rem;
            color: #fff;
        }
        
        .entry-player .player-pos {
            font-size: 0.7rem;
            color: #aaa;
            margin-top: 2px;
        }
        
        .entry-player .remove-btn {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 107, 107, 0.2);
            border-radius: 50%;
            color: #ff6b6b;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
            margin-left: 8px;
        }
        
        .entry-player:hover .remove-btn {
            opacity: 1;
        }
        
        .entry-player .remove-btn:hover {
            background: #ff6b6b;
            color: #fff;
        }
        
        /* ÏÑ†Ïàò ÌïòÏù¥ÎùºÏù¥Ìä∏ */
        .entry-player.highlighted {
            background: linear-gradient(135deg, rgba(254, 202, 87, 0.3) 0%, rgba(254, 202, 87, 0.15) 100%);
            border: 2px solid #feca57;
            box-shadow: 0 0 15px rgba(254, 202, 87, 0.4);
            transform: scale(1.05);
        }
        
        .player-chip.highlighted {
            background: rgba(254, 202, 87, 0.2);
            border-color: #feca57;
            box-shadow: 0 0 10px rgba(254, 202, 87, 0.3);
        }
        
        .highlight-info {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #feca57 0%, #f39c12 100%);
            color: #1a1a2e;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1rem;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(254, 202, 87, 0.4);
            display: none;
            align-items: center;
            gap: 15px;
        }
        
        .highlight-info.show {
            display: flex;
        }
        
        .highlight-info .player-name {
            font-size: 1.1rem;
        }
        
        .highlight-info .quarter-list {
            display: flex;
            gap: 8px;
        }
        
        .highlight-info .quarter-badge {
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .highlight-info .quarter-badge.vs-a {
            background: rgba(255, 107, 107, 0.3);
            color: #ff6b6b;
        }
        
        .highlight-info .quarter-badge.vs-c {
            background: rgba(72, 219, 251, 0.3);
            color: #48dbfb;
        }
        
        .highlight-info .close-btn {
            margin-left: 10px;
            cursor: pointer;
            opacity: 0.7;
            font-size: 1.2rem;
        }
        
        .highlight-info .close-btn:hover {
            opacity: 1;
        }
        
        .quarter-count-display {
            min-width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            color: #888;
        }
        
        .quarter-count-display.ok { color: #4caf50; }
        .quarter-count-display.warn { color: #ff6b6b; }
        
        /* ÏÑ†ÏàòÎ≥Ñ Ï∂úÏ†Ñ ÌÜµÍ≥Ñ */
        .stats-summary {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .stats-title {
            font-size: 0.9rem;
            color: #feca57;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .stats-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 0.85rem;
        }
        
        .stat-item .stat-name {
            margin-right: 8px;
        }
        
        .stat-item .stat-value {
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .stat-item .stat-value.high {
            background: rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }
        
        .stat-item .stat-value.medium {
            background: rgba(254, 202, 87, 0.3);
            color: #feca57;
        }
        
        .stat-item .stat-value.low {
            background: rgba(255, 107, 107, 0.3);
            color: #ff6b6b;
        }
        
        /* ÎØ∏Î¶¨Î≥¥Í∏∞ & Îã§Ïö¥Î°úÎìú ÏòÅÏó≠ */
        .preview-section {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
        }
        
        .preview-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #4caf50;
        }
        
        .preview-container {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 10px;
            overflow-x: auto;
        }
        
        /* Í≥µÏú† Ïù¥ÎØ∏ÏßÄ Ïä§ÌÉÄÏùº */
        .share-card {
            width: 900px;
            padding: 30px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .share-title {
            text-align: center;
            font-size: 2.2rem;
            font-weight: 700;
            color: #feca57;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #feca57;
        }
        
        .share-match {
            margin-bottom: 30px;
        }
        
        .share-match-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            padding: 10px 15px;
            border-radius: 8px;
        }
        
        .share-match.vs-a .share-match-title {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }
        
        .share-match.vs-c .share-match-title {
            background: rgba(72, 219, 251, 0.2);
            color: #48dbfb;
        }
        
        .share-quarter-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
        }
        
        .share-quarter-label {
            min-width: 70px;
            font-weight: 700;
            font-size: 1.1rem;
            color: #feca57;
        }
        
        .share-players {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            flex: 1;
        }
        
        .share-player {
            display: flex;
            align-items: center;
            padding: 8px 14px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
        }
        
        .share-player .num {
            width: 32px;
            height: 32px;
            background: #feca57;
            color: #1a1a2e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.95rem;
            margin-right: 10px;
        }
        
        .share-player .name {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .share-info-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 25px;
            padding: 12px 20px;
            background: rgba(254, 202, 87, 0.15);
            border-radius: 10px;
            border: 1px solid rgba(254, 202, 87, 0.3);
        }
        
        .share-info-item {
            font-size: 1.1rem;
            font-weight: 600;
            color: #feca57;
        }
        
        .share-stats {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
        }
        
        .share-stats-title {
            font-size: 1rem;
            color: #feca57;
            margin-bottom: 10px;
        }
        
        .share-stats-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .share-stat-item {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 12px;
            background: #4caf50;
            color: #fff;
            font-size: 0.95rem;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
            z-index: 1001;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 40px;
            color: #666;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .legend {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: #aaa;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }
        
        .drag-hint {
            text-align: center;
            padding: 10px;
            color: #666;
            font-size: 0.85rem;
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: 8px;
            margin-top: 15px;
        }
        
        /* ÏÉÅÎåÄÌåÄ Î™ÖÎã® */
        .opponent-teams {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .opponent-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 15px;
            border-left: 4px solid;
        }
        
        .opponent-card.team-a {
            border-left-color: #ff6b6b;
        }
        
        .opponent-card.team-c {
            border-left-color: #48dbfb;
        }
        
        .opponent-title {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .opponent-card.team-a .opponent-title {
            color: #ff6b6b;
        }
        
        .opponent-card.team-c .opponent-title {
            color: #48dbfb;
        }
        
        .opponent-players {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .opponent-player {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            font-size: 0.8rem;
        }
        
        .opponent-player .opp-num {
            font-weight: 700;
            margin-right: 5px;
            opacity: 0.7;
        }
        
        .opponent-player.key-player {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .opponent-player.key-player::after {
            content: '‚ö°';
            margin-left: 4px;
            font-size: 0.7rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèÄ BÌåÄ (Ïù¥Ïú§ÏÇº) ÏóîÌä∏Î¶¨ Íµ¨ÏÑ±</h1>
        
        <div class="round-selector">
            <label>ÎùºÏö¥Îìú:</label>
            <input type="number" id="roundNumber" value="1" min="1" max="20">
            
            <label style="margin-left: 20px;">Í≤ΩÍ∏∞ ÏàúÏÑú:</label>
            <select id="matchOrder" onchange="updateMatchOrderDisplay()">
                <option value="1">1Î≤à: A-B ‚Üí B-C ‚Üí C-A</option>
                <option value="2">2Î≤à: B-C ‚Üí C-A ‚Üí A-B</option>
                <option value="3">3Î≤à: C-A ‚Üí A-B ‚Üí B-C</option>
            </select>
            
            <label style="margin-left: 20px;">ÎãπÎ≤àÌåÄ:</label>
            <select id="dutyTeam">
                <option value="">Ìï¥ÎãπÏóÜÏùå</option>
                <option value="B">BÌåÄ (Ïö∞Î¶¨ÌåÄ)</option>
                <option value="A">AÌåÄ</option>
                <option value="C">CÌåÄ</option>
            </select>
            
            <label style="margin-left: 20px;">Ïú†ÎãàÌèº:</label>
            <div class="uniform-selector">
                <button class="uniform-btn white" onclick="selectUniform('white')" title="ÌôîÏù¥Ìä∏">
                    <span class="uniform-icon">üëï</span>
                </button>
                <button class="uniform-btn red" onclick="selectUniform('red')" title="Î†àÎìú">
                    <span class="uniform-icon">üëï</span>
                </button>
                <button class="uniform-btn black" onclick="selectUniform('black')" title="Î∏îÎûô">
                    <span class="uniform-icon">üëï</span>
                </button>
            </div>
        </div>
        
        <div class="match-order-info" id="matchOrderInfo">
            <!-- Í≤ΩÍ∏∞ ÏàúÏÑú ÌëúÏãú -->
        </div>
        
        <div class="main-layout">
            <!-- ÏÑ†Ïàò Ìå®ÎÑê -->
            <div class="player-panel">
                <div class="panel-title">
                    BÌåÄ ÏÑ†Ïàò Î™ÖÎã®
                    <span class="attendance-count" id="attendanceCount">Ï∞∏ÏÑù: 0Î™Ö</span>
                </div>
                <div class="player-list" id="playerList"></div>
                
                <div class="legend">
                    <div class="legend-item"><div class="legend-color" style="background:#e74c3c"></div>PG</div>
                    <div class="legend-item"><div class="legend-color" style="background:#e67e22"></div>SG</div>
                    <div class="legend-item"><div class="legend-color" style="background:#27ae60"></div>FW</div>
                    <div class="legend-item"><div class="legend-color" style="background:#3498db"></div>C</div>
                </div>
                
                <div class="drag-hint">
                    ‚úã ÏÑ†ÏàòÎ•º ÎìúÎûòÍ∑∏ÌïòÏó¨<br>ÏóîÌä∏Î¶¨Ïóê ÏßÅÏ†ë Î∞∞ÏπòÌïòÏÑ∏Ïöî
                </div>
            </div>
            
            <!-- ÏóîÌä∏Î¶¨ ÏòÅÏó≠ -->
            <div class="entry-area">
                <div class="action-bar">
                    <button class="action-btn primary" onclick="generateEntry()">‚ö° ÏóîÌä∏Î¶¨ ÏûêÎèô ÏÉùÏÑ±</button>
                    <button class="action-btn secondary" onclick="clearEntry()">üóëÔ∏è ÏóîÌä∏Î¶¨ Ï¥àÍ∏∞Ìôî</button>
                    <button class="action-btn success" onclick="generateShareImage()">üì∏ Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ & Ï†ÄÏû•</button>
                </div>
                
                <!-- ÏÉÅÎåÄÌåÄ Î™ÖÎã® -->
                <div class="opponent-teams">
                    <div class="opponent-card team-a">
                        <div class="opponent-title">üî¥ AÌåÄ (Ï±ÑÏòÅÏßÑ)</div>
                        <div class="opponent-players" id="teamAPlayers"></div>
                    </div>
                    <div class="opponent-card team-c">
                        <div class="opponent-title">üîµ CÌåÄ (Ïã¨Ï∞ΩÌòÑ)</div>
                        <div class="opponent-players" id="teamCPlayers"></div>
                    </div>
                </div>
                
                <div class="entry-cards" id="entryCards">
                    <div class="empty-state">
                        ÏôºÏ™ΩÏóêÏÑú Ï∞∏ÏÑù ÏÑ†ÏàòÎ•º ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉùÌïòÍ±∞ÎÇò<br>
                        ÎìúÎûòÍ∑∏ÌïòÏó¨ ÏßÅÏ†ë ÏóîÌä∏Î¶¨Ïóê Î∞∞ÏπòÌïòÏÑ∏Ïöî<br><br>
                        "ÏóîÌä∏Î¶¨ ÏûêÎèô ÏÉùÏÑ±" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥<br>
                        Ìè¨ÏßÄÏÖò Î∞∏Îü∞Ïä§Î•º Í≥†Î†§ÌïòÏó¨ ÏûêÎèô Ìé∏ÏÑ±Îê©ÎãàÎã§
                    </div>
                </div>
                
                <!-- ÎØ∏Î¶¨Î≥¥Í∏∞ ÏòÅÏó≠ -->
                <div class="preview-section" id="previewSection" style="display:none;">
                    <div class="preview-title">üì∏ Í≥µÏú† Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ (ÏïÑÎûò Ïù¥ÎØ∏ÏßÄÎ•º Ïö∞ÌÅ¥Î¶≠ÌïòÏó¨ Ï†ÄÏû•)</div>
                    <div class="preview-container">
                        <div class="share-card" id="shareCard"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    <div class="highlight-info" id="highlightInfo">
        <span class="player-name" id="highlightPlayerName"></span>
        <div class="quarter-list" id="highlightQuarters"></div>
        <span class="close-btn" onclick="clearHighlight()">‚úï</span>
    </div>
    
    <script>
        // BÌåÄ ÏÑ†Ïàò Îç∞Ïù¥ÌÑ∞ (Ìè¨ÏßÄÏÖò Ìè¨Ìï®)
        const bTeamPlayers = [
            { number: 4, name: 'ÍπÄÎèàÍ∑ú', position: 'C', positionFull: 'ÏÑºÌÑ∞', priority: true },
            { number: 18, name: 'ÍπÄÏäπÎØº', position: 'FW', positionFull: 'Ìè¨ÏõåÎìú' },
            { number: 20, name: 'Ï†ïÌù¨Ïõê', position: 'PG', positionFull: 'Ìè¨Ïù∏Ìä∏Í∞ÄÎìú' },
            { number: 21, name: 'Í∂åÍ∏∞ÌòÑ', position: 'FW', positionFull: 'Ìè¨ÏõåÎìú' },
            { number: 22, name: 'Ïù¥Ïú§ÏÇº', position: 'SG', positionFull: 'ÏäàÌåÖÍ∞ÄÎìú', priority: true },
            { number: 23, name: 'Î∞±Í≤ΩÏ§Ä', position: 'FW/C', positionFull: 'Ìè¨ÏõåÎìú/ÏÑºÌÑ∞', priority: true },
            { number: 24, name: 'Ïú†ÏßÄÌòï', position: 'SG', positionFull: 'ÏäàÌåÖÍ∞ÄÎìú', priority: true },
            { number: 30, name: 'ÍπÄÎèôÍ¥ë', position: 'PG', positionFull: 'Ìè¨Ïù∏Ìä∏Í∞ÄÎìú', priority: true },
            { number: 31, name: 'ÍπÄÏ§ÄÌôò', position: 'FW', positionFull: 'Ìè¨ÏõåÎìú' },
            { number: 35, name: 'Í∞ïÍ∂åÏó¥', position: 'FW', positionFull: 'Ìè¨ÏõåÎìú' },
            { number: 47, name: 'ÏÜ°ÏÑ±Ïùº', position: 'FW', positionFull: 'Ìè¨ÏõåÎìú' },
            { number: 50, name: 'Ïù¥Ï¢ÖÌòÅ', position: 'FW/C', positionFull: 'Ìè¨ÏõåÎìú/ÏÑºÌÑ∞' },
            { number: 78, name: 'ÏÜ°ÏßÑÏàò', position: 'FW', positionFull: 'Ìè¨ÏõåÎìú' }
        ];
        
        // AÌåÄ ÏÑ†Ïàò Îç∞Ïù¥ÌÑ∞ (Ï±ÑÏòÅÏßÑÌåÄ)
        const aTeamPlayers = [
            { number: 6, name: 'ÏïàÎ≥ëÏõÖ', key: true },
            { number: 9, name: 'ÍπÄÏßÑÎ∞∞' },
            { number: 10, name: 'ÏïàÎ≥ëÏòÅ' },
            { number: 17, name: 'Ï±ÑÏòÅÏßÑ', key: true },
            { number: 19, name: 'Ï†ïÏö©Ï£º' },
            { number: 27, name: 'Ïã†Ï§ÄÌòÑ' },
            { number: 32, name: 'ÍπÄÏ†ïÌò∏', key: true },
            { number: 40, name: 'Ï†ïÎ¨∏Í¥Ä' },
            { number: 41, name: 'Ïù¥ÎèôÏÑù' },
            { number: 52, name: 'Í≥ΩÏÑ±Ïû¨' },
            { number: 80, name: 'ÏµúÏû¨ÎØº' },
            { number: 93, name: 'Í∞ïÏû¨Ìõà', key: true },
            { number: 99, name: 'ÏµúÌö®Î¶º' }
        ];
        
        // CÌåÄ ÏÑ†Ïàò Îç∞Ïù¥ÌÑ∞ (Ïã¨Ï∞ΩÌòÑÌåÄ)
        const cTeamPlayers = [
            { number: 0, name: 'Ïù¥Ïû•Ïõê', key: true },
            { number: 2, name: 'Ïò§Ï¢ÖÌïÑ' },
            { number: 7, name: 'Í∂åÏù∏Ìöå' },
            { number: 14, name: 'Í≥†ÎØºÍ∑º' },
            { number: 16, name: 'ÍπÄÌòÑÏ§Ä' },
            { number: 25, name: 'ÏÜêÏû¨ÎØº' },
            { number: 28, name: 'Í∞ïÌö®ÏßÑ' },
            { number: 34, name: 'Ïù¥ÏäπÌòÑ', key: true },
            { number: 38, name: 'Í∏∏ÏùÑÏÑ≠' },
            { number: 45, name: 'ÍπÄÏõêÎ≤î' },
            { number: 46, name: 'Ïã¨Ï∞ΩÌòÑ', key: true },
            { number: 72, name: 'ÍπÄÏ£ºÏ≤†', key: true },
            { number: 92, name: 'Î∞ïÎ¨∏Ïö©' }
        ];
        
        // ÏÉÅÎåÄÌåÄ Î™ÖÎã® Î†åÎçîÎßÅ
        function renderOpponentTeams() {
            const teamAContainer = document.getElementById('teamAPlayers');
            const teamCContainer = document.getElementById('teamCPlayers');
            
            teamAContainer.innerHTML = aTeamPlayers
                .sort((a, b) => a.number - b.number)
                .map(p => `
                    <span class="opponent-player ${p.key ? 'key-player' : ''}">
                        <span class="opp-num">${p.number}</span>${p.name}
                    </span>
                `).join('');
            
            teamCContainer.innerHTML = cTeamPlayers
                .sort((a, b) => a.number - b.number)
                .map(p => `
                    <span class="opponent-player ${p.key ? 'key-player' : ''}">
                        <span class="opp-num">${p.number}</span>${p.name}
                    </span>
                `).join('');
        }
        
        // Í≤ΩÍ∏∞ ÏàúÏÑú Ï†ïÎ≥¥
        // BÌåÄ Í∏∞Ï§Ä ÏøºÌÑ∞ ÏßÑÌñâ ÏàúÏÑú (Ïã§Ï†ú ÏãúÍ∞Ñ ÏàúÏÑú)
        // Í≤ΩÍ∏∞ ÏàúÏÑú 1: A-B(1,2Q) ‚Üí B-C(1,2Q) ‚Üí A-B(3,4Q) ‚Üí B-C(3,4Q)
        // Í≤ΩÍ∏∞ ÏàúÏÑú 2: B-C(1,2Q) ‚Üí B-C(3,4Q) ‚Üí A-B(1,2Q) ‚Üí A-B(3,4Q) (BÌåÄ Î®ºÏ†Ä 2Í≤ΩÍ∏∞ Ïó∞ÏÜç)
        // Í≤ΩÍ∏∞ ÏàúÏÑú 3: A-B(1,2Q) ‚Üí A-B(3,4Q) ‚Üí B-C(1,2Q) ‚Üí B-C(3,4Q) (AÌåÄ Î®ºÏ†Ä)
        
        const matchOrders = {
            '1': {
                name: 'A-B ‚Üí B-C ‚Üí C-A',
                // BÌåÄ Í∏∞Ï§Ä ÏøºÌÑ∞ ÏàúÏÑú: vsA(1,2Q) ‚Üí vsC(1,2Q) ‚Üí vsA(3,4Q) ‚Üí vsC(3,4Q)
                sequence: [
                    { match: 'vsA', quarter: 'q1', slot: 1 },
                    { match: 'vsA', quarter: 'q2', slot: 1 },
                    { match: 'vsC', quarter: 'q1', slot: 2 },
                    { match: 'vsC', quarter: 'q2', slot: 2 },
                    // Ìú¥Ïãù (C-A Í≤ΩÍ∏∞)
                    { match: 'vsA', quarter: 'q3', slot: 4 },
                    { match: 'vsA', quarter: 'q4', slot: 4 },
                    { match: 'vsC', quarter: 'q3', slot: 5 },
                    { match: 'vsC', quarter: 'q4', slot: 5 }
                ],
                restAfter: [2, 5], // 2Î≤àÏß∏, 5Î≤àÏß∏ Ïä¨Î°Ø ÌõÑ Ìú¥Ïãù
                display: [
                    { label: '1Í≤ΩÍ∏∞', teams: 'A-B', quarters: '1,2Q', bPlays: true },
                    { label: '2Í≤ΩÍ∏∞', teams: 'B-C', quarters: '1,2Q', bPlays: true },
                    { label: '3Í≤ΩÍ∏∞', teams: 'C-A', quarters: '1,2Q', bPlays: false },
                    { label: '4Í≤ΩÍ∏∞', teams: 'A-B', quarters: '3,4Q', bPlays: true },
                    { label: '5Í≤ΩÍ∏∞', teams: 'B-C', quarters: '3,4Q', bPlays: true },
                    { label: '6Í≤ΩÍ∏∞', teams: 'C-A', quarters: '3,4Q', bPlays: false }
                ]
            },
            '2': {
                name: 'B-C ‚Üí C-A ‚Üí A-B',
                // BÌåÄ Í∏∞Ï§Ä: vsC(1,2Q) ‚Üí Ìú¥Ïãù(C-A) ‚Üí vsA(1,2Q) ‚Üí vsC(3,4Q) ‚Üí Ìú¥Ïãù(C-A) ‚Üí vsA(3,4Q)
                sequence: [
                    { match: 'vsC', quarter: 'q1', slot: 1 },
                    { match: 'vsC', quarter: 'q2', slot: 1 },
                    // Ìú¥Ïãù (C-A Í≤ΩÍ∏∞)
                    { match: 'vsA', quarter: 'q1', slot: 3 },
                    { match: 'vsA', quarter: 'q2', slot: 3 },
                    { match: 'vsC', quarter: 'q3', slot: 4 },
                    { match: 'vsC', quarter: 'q4', slot: 4 },
                    // Ìú¥Ïãù (C-A Í≤ΩÍ∏∞)
                    { match: 'vsA', quarter: 'q3', slot: 6 },
                    { match: 'vsA', quarter: 'q4', slot: 6 }
                ],
                restAfter: [1, 4], // Ìú¥Ïãù ÏúÑÏπò
                display: [
                    { label: '1Í≤ΩÍ∏∞', teams: 'B-C', quarters: '1,2Q', bPlays: true },
                    { label: '2Í≤ΩÍ∏∞', teams: 'C-A', quarters: '1,2Q', bPlays: false },
                    { label: '3Í≤ΩÍ∏∞', teams: 'A-B', quarters: '1,2Q', bPlays: true },
                    { label: '4Í≤ΩÍ∏∞', teams: 'B-C', quarters: '3,4Q', bPlays: true },
                    { label: '5Í≤ΩÍ∏∞', teams: 'C-A', quarters: '3,4Q', bPlays: false },
                    { label: '6Í≤ΩÍ∏∞', teams: 'A-B', quarters: '3,4Q', bPlays: true }
                ]
            },
            '3': {
                name: 'C-A ‚Üí A-B ‚Üí B-C',
                // BÌåÄ Í∏∞Ï§Ä: Ìú¥Ïãù(C-A) ‚Üí vsA(1,2Q) ‚Üí vsC(1,2Q) ‚Üí Ìú¥Ïãù(C-A) ‚Üí vsA(3,4Q) ‚Üí vsC(3,4Q)
                sequence: [
                    // Ìú¥Ïãù (C-A Í≤ΩÍ∏∞)
                    { match: 'vsA', quarter: 'q1', slot: 2 },
                    { match: 'vsA', quarter: 'q2', slot: 2 },
                    { match: 'vsC', quarter: 'q1', slot: 3 },
                    { match: 'vsC', quarter: 'q2', slot: 3 },
                    // Ìú¥Ïãù (C-A Í≤ΩÍ∏∞)
                    { match: 'vsA', quarter: 'q3', slot: 5 },
                    { match: 'vsA', quarter: 'q4', slot: 5 },
                    { match: 'vsC', quarter: 'q3', slot: 6 },
                    { match: 'vsC', quarter: 'q4', slot: 6 }
                ],
                restAfter: [0, 3], // ÏãúÏûë Ï†Ñ, 3Î≤àÏß∏ ÌõÑ Ìú¥Ïãù
                display: [
                    { label: '1Í≤ΩÍ∏∞', teams: 'C-A', quarters: '1,2Q', bPlays: false },
                    { label: '2Í≤ΩÍ∏∞', teams: 'A-B', quarters: '1,2Q', bPlays: true },
                    { label: '3Í≤ΩÍ∏∞', teams: 'B-C', quarters: '1,2Q', bPlays: true },
                    { label: '4Í≤ΩÍ∏∞', teams: 'C-A', quarters: '3,4Q', bPlays: false },
                    { label: '5Í≤ΩÍ∏∞', teams: 'A-B', quarters: '3,4Q', bPlays: true },
                    { label: '6Í≤ΩÍ∏∞', teams: 'B-C', quarters: '3,4Q', bPlays: true }
                ]
            }
        };
        
        function updateMatchOrderDisplay() {
            const orderNum = document.getElementById('matchOrder').value;
            const order = matchOrders[orderNum];
            const container = document.getElementById('matchOrderInfo');
            
            container.innerHTML = order.display.map((slot, idx) => {
                const teamsHtml = slot.teams.split('-').map(t => 
                    t === 'B' ? `<span class="b-highlight">B</span>` : t
                ).join('-');
                
                return `
                    <div class="match-slot ${slot.bPlays ? 'current' : ''}">
                        <span class="slot-label">${slot.label}</span>
                        <span class="slot-teams">${teamsHtml}</span>
                        <span class="slot-quarters">${slot.quarters}</span>
                    </div>
                `;
            }).join('');
        }
        
        let selectedPlayers = [];
        let entryVsA = { q1: [], q2: [], q3: [], q4: [] };
        let entryVsC = { q1: [], q2: [], q3: [], q4: [] };
        let draggedPlayer = null;
        let dragSource = null;
        
        // Ïö¥ÏòÅÏßÑ Î∞∞Ï†ï
        let staffAssignments = {
            referee_outer: null,
            referee_center: null,
            referee_inner: null,
            scoreboard: null,
            record: null,
            sub_record: null,
            camera: null
        };
        
        const staffRoleNames = {
            referee_outer: 'Ïã¨Ìåê(Ïô∏Ï∏°)',
            referee_center: 'Ïã¨Ìåê(Ï§ëÏïô)',
            referee_inner: 'Ïã¨Ìåê(ÎÇ¥Ï∏°)',
            scoreboard: 'Ï†êÏàòÌåê',
            record: 'Í∏∞Î°ùÏßÄ',
            sub_record: 'Î∂ÄÍ∞ÄÍ∏∞Î°ù',
            camera: 'Ï¥¨ÏòÅ'
        };
        
        // Ïú†ÎãàÌèº ÏÉâÏÉÅ
        let selectedUniform = null;
        const uniformNames = {
            'white': 'ÌôîÏù¥Ìä∏',
            'red': 'Î†àÎìú',
            'black': 'Î∏îÎûô'
        };
        
        // ÌïòÏù¥ÎùºÏù¥Ìä∏Îêú ÏÑ†Ïàò
        let highlightedPlayer = null;
        
        function selectUniform(color) {
            selectedUniform = color;
            
            // Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.uniform-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`.uniform-btn.${color}`).classList.add('selected');
            
            showNotification(`Ïú†ÎãàÌèº: ${uniformNames[color]} ÏÑ†ÌÉù`);
        }
        
        // ÏÑ†Ïàò ÌïòÏù¥ÎùºÏù¥Ìä∏ ÌÜ†Í∏Ä
        function toggleHighlight(playerNumber) {
            if (highlightedPlayer === playerNumber) {
                clearHighlight();
            } else {
                highlightPlayer(playerNumber);
            }
        }
        
        // ÏÑ†Ïàò ÌïòÏù¥ÎùºÏù¥Ìä∏
        function highlightPlayer(playerNumber) {
            highlightedPlayer = playerNumber;
            const player = bTeamPlayers.find(p => p.number === playerNumber);
            
            // Ìï¥Îãπ ÏÑ†ÏàòÍ∞Ä ÏûàÎäî ÏøºÌÑ∞ Ï∞æÍ∏∞
            const quarters = [];
            ['q1', 'q2', 'q3', 'q4'].forEach(q => {
                if (entryVsA[q].some(p => p.number === playerNumber)) {
                    quarters.push({ match: 'vsA', quarter: q, label: `AÌåÄ ${q.toUpperCase()}` });
                }
                if (entryVsC[q].some(p => p.number === playerNumber)) {
                    quarters.push({ match: 'vsC', quarter: q, label: `CÌåÄ ${q.toUpperCase()}` });
                }
            });
            
            // ÌïòÏù¥ÎùºÏù¥Ìä∏ Ï†ïÎ≥¥ ÌëúÏãú
            document.getElementById('highlightPlayerName').textContent = `#${player.number} ${player.name}`;
            document.getElementById('highlightQuarters').innerHTML = quarters.length > 0 
                ? quarters.map(q => `<span class="quarter-badge ${q.match === 'vsA' ? 'vs-a' : 'vs-c'}">${q.label}</span>`).join('')
                : '<span style="opacity: 0.7">Î∞∞Ï†ïÎêú ÏøºÌÑ∞ ÏóÜÏùå</span>';
            document.getElementById('highlightInfo').classList.add('show');
            
            // ÏóîÌä∏Î¶¨ Ïπ¥Îìú Îã§Ïãú Î†åÎçîÎßÅ (ÌïòÏù¥ÎùºÏù¥Ìä∏ Ï†ÅÏö©)
            renderEntryCards();
            renderPlayerList();
        }
        
        // ÌïòÏù¥ÎùºÏù¥Ìä∏ Ìï¥Ï†ú
        function clearHighlight() {
            highlightedPlayer = null;
            document.getElementById('highlightInfo').classList.remove('show');
            renderEntryCards();
            renderPlayerList();
        }

        // ÌïòÏù¥ÎùºÏù¥Ìä∏ ÌåùÏóÖ ÎÇ¥Ïö© ÏóÖÎç∞Ïù¥Ìä∏ (ÏøºÌÑ∞ Ï∂îÍ∞Ä/ÏÇ≠Ï†ú Ïãú)
        function updateHighlightInfo() {
            if (highlightedPlayer === null) return;

            const player = bTeamPlayers.find(p => p.number === highlightedPlayer);
            if (!player) return;

            const quarters = [];
            ['q1', 'q2', 'q3', 'q4'].forEach(q => {
                if (entryVsA[q].some(p => p.number === highlightedPlayer)) {
                    quarters.push({ match: 'vsA', quarter: q, label: `AÌåÄ ${q.toUpperCase()}` });
                }
                if (entryVsC[q].some(p => p.number === highlightedPlayer)) {
                    quarters.push({ match: 'vsC', quarter: q, label: `CÌåÄ ${q.toUpperCase()}` });
                }
            });

            document.getElementById('highlightQuarters').innerHTML = quarters.length > 0
                ? quarters.map(q => `<span class="quarter-badge ${q.match === 'vsA' ? 'vs-a' : 'vs-c'}">${q.label}</span>`).join('')
                : '<span style="opacity: 0.7">Î∞∞Ï†ïÎêú ÏøºÌÑ∞ ÏóÜÏùå</span>';
        }

        function getPositionBadgeClass(pos) {
            if (pos.includes('PG')) return 'pg';
            if (pos.includes('SG')) return 'sg';
            if (pos.includes('C') && !pos.includes('FW')) return 'c';
            return 'fw';
        }
        
        // ÏÑ†ÏàòÎ≥Ñ Ï¥ù ÏøºÌÑ∞ Ïàò Í≥ÑÏÇ∞
        function getPlayerQuarterCounts() {
            const counts = {};
            bTeamPlayers.forEach(p => counts[p.number] = 0);
            
            ['q1', 'q2', 'q3', 'q4'].forEach(q => {
                entryVsA[q].forEach(p => {
                    if (counts[p.number] !== undefined) counts[p.number]++;
                });
                entryVsC[q].forEach(p => {
                    if (counts[p.number] !== undefined) counts[p.number]++;
                });
            });
            
            return counts;
        }
        
        function getQuarterCountClass(count) {
            if (count >= 6) return 'high';
            if (count >= 3) return 'medium';
            return 'low';
        }
        
        function renderPlayerList() {
            const container = document.getElementById('playerList');
            const quarterCounts = getPlayerQuarterCounts();
            
            container.innerHTML = bTeamPlayers.map(player => {
                const isSelected = selectedPlayers.some(p => p.number === player.number);
                const isHighlighted = highlightedPlayer === player.number;
                const badgeClass = getPositionBadgeClass(player.position);
                const qCount = quarterCounts[player.number];
                const qCountClass = getQuarterCountClass(qCount);
                
                return `
                    <div class="player-chip ${isSelected ? 'selected' : ''} ${isHighlighted ? 'highlighted' : ''}" 
                         draggable="true"
                         ondragstart="handleDragStart(event, ${player.number}, 'pool')"
                         ondragend="handleDragEnd(event)"
                         onclick="togglePlayer(${player.number})">
                        <div class="number">${player.number}</div>
                        <div class="info">
                            <div class="name">${player.name}${player.priority ? ' ‚≠ê' : ''}</div>
                            <div class="position">
                                <span class="position-badge ${badgeClass}">${player.position}</span>
                                ${player.positionFull}
                            </div>
                        </div>
                        <div class="quarter-count ${qCountClass}">${qCount}ÏøºÌÑ∞</div>
                        <div class="check">‚úì</div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('attendanceCount').textContent = `Ï∞∏ÏÑù: ${selectedPlayers.length}Î™Ö`;
        }
        
        function togglePlayer(number) {
            const player = bTeamPlayers.find(p => p.number === number);
            const index = selectedPlayers.findIndex(p => p.number === number);
            
            if (index === -1) {
                selectedPlayers.push(player);
            } else {
                selectedPlayers.splice(index, 1);
            }
            
            renderPlayerList();
        }
        
        function handleDragStart(event, playerNumber, source) {
            const player = bTeamPlayers.find(p => p.number === playerNumber);
            draggedPlayer = player;
            dragSource = source;
            event.target.classList.add('dragging');
            event.dataTransfer.effectAllowed = 'move';
        }
        
        function handleDragEnd(event) {
            event.target.classList.remove('dragging');
            draggedPlayer = null;
            dragSource = null;
            document.querySelectorAll('.quarter-players').forEach(el => {
                el.classList.remove('drag-over');
            });
        }
        
        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('drag-over');
        }
        
        function handleDragLeave(event) {
            event.currentTarget.classList.remove('drag-over');
        }
        
        function handleDrop(event, match, quarter) {
            event.preventDefault();
            event.currentTarget.classList.remove('drag-over');
            
            if (!draggedPlayer) return;
            
            const entry = match === 'vsA' ? entryVsA : entryVsC;
            
            // Ïù¥ÎØ∏ Ìï¥Îãπ ÏøºÌÑ∞Ïóê ÏûàÎäîÏßÄ ÌôïÏù∏
            if (entry[quarter].some(p => p.number === draggedPlayer.number)) {
                showNotification('Ïù¥ÎØ∏ Ìï¥Îãπ ÏøºÌÑ∞Ïóê ÏûàÏäµÎãàÎã§', 'warn');
                return;
            }
            
            // 5Î™Ö Ï†úÌïú
            if (entry[quarter].length >= 5) {
                showNotification('ÏøºÌÑ∞Îãπ 5Î™ÖÍπåÏßÄÎßå Í∞ÄÎä•Ìï©ÎãàÎã§', 'warn');
                return;
            }
            
            // ÏÑ†Ïàò Ï∂îÍ∞Ä
            entry[quarter].push({...draggedPlayer});
            
            // Ï∞∏ÏÑù ÏÑ†ÏàòÏóê ÏóÜÏúºÎ©¥ Ï∂îÍ∞Ä
            if (!selectedPlayers.some(p => p.number === draggedPlayer.number)) {
                selectedPlayers.push(draggedPlayer);
            }
            
            renderPlayerList();
            renderEntryCards();
            updateHighlightInfo();
            showNotification(`${draggedPlayer.name} ‚Üí ${match === 'vsA' ? 'AÌåÄÏ†Ñ' : 'CÌåÄÏ†Ñ'} ${quarter.toUpperCase()} Î∞∞Ïπò`);
        }
        
        // Ïö¥ÏòÅÏßÑ ÎìúÎ°≠ Ï≤òÎ¶¨
        function handleStaffDrop(event, role) {
            event.preventDefault();
            event.currentTarget.classList.remove('drag-over');
            
            if (!draggedPlayer) return;
            
            // Ïù¥ÎØ∏ Îã§Î•∏ Ïó≠Ìï†Ïóê Î∞∞Ï†ïÎêòÏñ¥ ÏûàÏúºÎ©¥ Ï†úÍ±∞
            Object.keys(staffAssignments).forEach(key => {
                if (staffAssignments[key] && staffAssignments[key].number === draggedPlayer.number) {
                    staffAssignments[key] = null;
                }
            });
            
            // ÏÉà Ïó≠Ìï†Ïóê Î∞∞Ï†ï
            staffAssignments[role] = {...draggedPlayer};
            
            renderStaffSlots();
            showNotification(`${draggedPlayer.name} ‚Üí ${staffRoleNames[role]} Î∞∞Ï†ï`);
        }
        
        // Ïö¥ÏòÅÏßÑ Ïä¨Î°Ø Î†åÎçîÎßÅ
        function renderStaffSlots() {
            Object.keys(staffAssignments).forEach(role => {
                const player = staffAssignments[role];
                const slotElement = document.getElementById(`staff_${role}`);
                const slotContainer = slotElement.parentElement;
                
                if (player) {
                    slotElement.innerHTML = `${player.number} ${player.name}`;
                    slotElement.classList.remove('empty');
                    slotContainer.classList.add('filled');
                    
                    // ÏÇ≠Ï†ú Î≤ÑÌäº Ï∂îÍ∞Ä
                    if (!slotContainer.querySelector('.remove-staff')) {
                        const removeBtn = document.createElement('span');
                        removeBtn.className = 'remove-staff';
                        removeBtn.innerHTML = '‚úï';
                        removeBtn.onclick = (e) => {
                            e.stopPropagation();
                            removeStaff(role);
                        };
                        slotContainer.appendChild(removeBtn);
                    }
                } else {
                    slotElement.innerHTML = '-';
                    slotElement.classList.add('empty');
                    slotContainer.classList.remove('filled');
                    
                    const removeBtn = slotContainer.querySelector('.remove-staff');
                    if (removeBtn) removeBtn.remove();
                }
            });
        }
        
        // Ïö¥ÏòÅÏßÑ Ï†úÍ±∞
        function removeStaff(role) {
            const player = staffAssignments[role];
            staffAssignments[role] = null;
            renderStaffSlots();
            if (player) {
                showNotification(`${player.name} Ïö¥ÏòÅÏßÑ Ìï¥Ï†ú`);
            }
        }
        
        // Ïö¥ÏòÅÏßÑ Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî
        function clearStaff() {
            Object.keys(staffAssignments).forEach(key => {
                staffAssignments[key] = null;
            });
            renderStaffSlots();
            showNotification('Ïö¥ÏòÅÏßÑ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }
        
        function handleEntryDragStart(event, match, quarter, index) {
            const entry = match === 'vsA' ? entryVsA : entryVsC;
            draggedPlayer = entry[quarter][index];
            dragSource = { match, quarter, index };
            event.target.classList.add('dragging');
        }
        
        function removeFromQuarter(match, quarter, index) {
            const entry = match === 'vsA' ? entryVsA : entryVsC;
            const removed = entry[quarter].splice(index, 1)[0];
            renderPlayerList();
            renderEntryCards();
            updateHighlightInfo();
            showNotification(`${removed.name} Ï†úÍ±∞Îê®`);
        }
        
        function generateEntry() {
            if (selectedPlayers.length < 5) {
                showNotification('ÏµúÏÜå 5Î™Ö Ïù¥ÏÉÅ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî', 'warn');
                return;
            }
            
            const orderNum = document.getElementById('matchOrder').value;
            const order = matchOrders[orderNum];
            
            const totalSlots = 8 * 5; // 8ÏøºÌÑ∞ x 5Î™Ö
            const playerCount = selectedPlayers.length;
            const baseQuarters = Math.floor(totalSlots / playerCount);
            const extraSlots = totalSlots % playerCount;
            
            // Ïö∞ÏÑ† Ìé∏ÏÑ± ÏÑ†Ïàò
            const priorityPlayers = selectedPlayers.filter(p => p.priority);
            const normalPlayers = selectedPlayers.filter(p => !p.priority);
            
            // Î™©Ìëú ÏøºÌÑ∞ Ïàò ÏÑ§Ï†ï
            const targetQuarters = {};
            let extraRemaining = extraSlots;
            
            priorityPlayers.forEach(p => {
                if (extraRemaining > 0) {
                    targetQuarters[p.number] = baseQuarters + 1;
                    extraRemaining--;
                } else {
                    targetQuarters[p.number] = baseQuarters;
                }
            });
            
            normalPlayers.forEach(p => {
                if (extraRemaining > 0) {
                    targetQuarters[p.number] = baseQuarters + 1;
                    extraRemaining--;
                } else {
                    targetQuarters[p.number] = baseQuarters;
                }
            });
            
            // ÌòÑÏû¨ Î∞∞Ï†ïÎêú ÏøºÌÑ∞ Ï∂îÏ†Å
            const currentQuarters = {};
            selectedPlayers.forEach(p => currentQuarters[p.number] = 0);
            
            // Ïó∞ÏÜç Ï∂úÏ†Ñ Ï∂îÏ†Å (Ï≤¥Î†• Í¥ÄÎ¶¨)
            const consecutivePlay = {};
            selectedPlayers.forEach(p => consecutivePlay[p.number] = 0);
            
            // ÎßàÏßÄÎßâ Ï∂úÏ†Ñ Ïä¨Î°Ø Ï∂îÏ†Å
            const lastPlaySlot = {};
            selectedPlayers.forEach(p => lastPlaySlot[p.number] = -999);
            
            // Ìè¨ÏßÄÏÖòÎ≥Ñ Î∂ÑÎ•ò
            const guards = selectedPlayers.filter(p => p.position.includes('PG') || p.position.includes('SG'));
            const centers = selectedPlayers.filter(p => p.position.includes('C') && !p.position.includes('FW'));
            const forwardCenters = selectedPlayers.filter(p => p.position.includes('FW') && p.position.includes('C'));
            
            // Î∞∞Ïó¥ ÏÖîÌîå Ìï®Ïàò
            function shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }
            
            // ÏøºÌÑ∞ Ï§ëÏöîÎèÑ (4Q > 3Q > 1Q > 2Q)
            function getQuarterImportance(quarter) {
                const importance = { 'q4': 4, 'q3': 3, 'q1': 2, 'q2': 1 };
                return importance[quarter] || 0;
            }
            
            // Ïä¨Î°Ø Í∞Ñ Í±∞Î¶¨ Í≥ÑÏÇ∞ (Ìú¥Ïãù Í≥†Î†§)
            function getSlotDistance(slot1, slot2) {
                return Math.abs(slot2 - slot1);
            }
            
            // ÏÑ†Ïàò ÏÑ†ÌÉù Ìï®Ïàò (Ï≤¥Î†• ÏïàÎ∞∞ Í≥†Î†§)
            function getAvailablePlayers(exclude, currentSlot, isImportantQuarter, positionGroup = null) {
                let pool = positionGroup || selectedPlayers;
                const filtered = pool
                    .filter(p => !exclude.some(e => e.number === p.number))
                    .filter(p => currentQuarters[p.number] < targetQuarters[p.number]);
                
                // Ï†êÏàò Í≥ÑÏÇ∞ Ìï®Ïàò
                function calculateScore(player) {
                    let score = 0;
                    
                    // 1. Î™©Ìëú ÎåÄÎπÑ ÎÇ®ÏùÄ ÏøºÌÑ∞ (ÎÜíÏùÑÏàòÎ°ù Ïö∞ÏÑ†)
                    const remaining = targetQuarters[player.number] - currentQuarters[player.number];
                    score += remaining * 100;
                    
                    // 2. Ïö∞ÏÑ† ÏÑ†Ïàò Í∞ÄÏÇ∞Ï†ê (Ï§ëÏöî ÏøºÌÑ∞Ïùº ÎïåÎßå)
                    if (isImportantQuarter && player.priority) {
                        score += 50;
                    }
                    if (!isImportantQuarter && player.priority) {
                        score -= 30; // Îçú Ï§ëÏöîÌïú ÏøºÌÑ∞ÏóêÏÑúÎäî ÏùºÎ∞ò ÏÑ†Ïàò Ïö∞ÏÑ†
                    }
                    
                    // 3. Ïó∞ÏÜç Ï∂úÏ†Ñ ÌéòÎÑêÌã∞ (2Ïó∞ÏÜç Ïù¥ÏÉÅÏù¥Î©¥ Í∞êÏ†ê)
                    const slotDistance = getSlotDistance(lastPlaySlot[player.number], currentSlot);
                    if (slotDistance === 1) {
                        // Î∞îÎ°ú ÏßÅÏ†Ñ Ïä¨Î°ØÏóêÏÑú Îõ∞ÏóàÏùå (Ïó∞ÏÜç Ï∂úÏ†Ñ)
                        score -= 80; // ÌÅ∞ ÌéòÎÑêÌã∞
                    } else if (slotDistance === 0) {
                        // Í∞ôÏùÄ Ïä¨Î°Ø (2ÏøºÌÑ∞ Ïó∞ÏÜç) - ÏïΩÍ∞ÑÏùò ÌéòÎÑêÌã∞
                        score -= 20;
                    }
                    
                    // 4. ÎÑàÎ¨¥ Ïò§Îûò Ïâ∞ ÏÑ†Ïàò Í∞ÄÏÇ∞Ï†ê
                    if (slotDistance >= 3 && currentQuarters[player.number] > 0) {
                        score += 30; // Ïò§Îûò Ïâ¨ÏóàÏúºÎ©¥ Í∞ÄÏÇ∞Ï†ê
                    }
                    
                    // 5. ÎûúÎç§ ÏöîÏÜå (Í∞ôÏùÄ Ï°∞Í±¥ÏóêÏÑú Î≥ÄÌôî)
                    score += Math.random() * 20;
                    
                    return score;
                }
                
                // Ï†êÏàòÏàú Ï†ïÎ†¨
                return filtered.sort((a, b) => calculateScore(b) - calculateScore(a));
            }
            
            function fillQuarter(quarterPlayers, currentSlot, isImportantQuarter) {
                const needed = 5 - quarterPlayers.length;
                if (needed <= 0) return;
                
                const available = getAvailablePlayers(quarterPlayers, currentSlot, isImportantQuarter);
                
                for (let i = 0; i < needed && i < available.length; i++) {
                    quarterPlayers.push(available[i]);
                    currentQuarters[available[i].number]++;
                }
                
                // Í∑∏ÎûòÎèÑ Î∂ÄÏ°±ÌïòÎ©¥ ÏïÑÎ¨¥ÎÇò Ï∂îÍ∞Ä
                if (quarterPlayers.length < 5) {
                    const anyAvailable = shuffleArray(
                        selectedPlayers.filter(p => !quarterPlayers.some(q => q.number === p.number))
                    ).sort((a, b) => currentQuarters[a.number] - currentQuarters[b.number]);
                    
                    while (quarterPlayers.length < 5 && anyAvailable.length > 0) {
                        const player = anyAvailable.shift();
                        quarterPlayers.push(player);
                        currentQuarters[player.number]++;
                    }
                }
            }
            
            function createBalancedQuarter(currentSlot, isImportantQuarter) {
                const quarterPlayers = [];
                
                // 1. Í∞ÄÎìú 1-2Î™Ö
                const availableGuards = getAvailablePlayers(quarterPlayers, currentSlot, isImportantQuarter, guards);
                const guardCount = Math.min(2, availableGuards.length);
                for (let i = 0; i < guardCount; i++) {
                    quarterPlayers.push(availableGuards[i]);
                    currentQuarters[availableGuards[i].number]++;
                }
                
                // 2. ÏÑºÌÑ∞ 1Î™Ö
                const availableCenters = getAvailablePlayers(quarterPlayers, currentSlot, isImportantQuarter, [...centers, ...forwardCenters]);
                if (availableCenters.length > 0) {
                    quarterPlayers.push(availableCenters[0]);
                    currentQuarters[availableCenters[0].number]++;
                }
                
                // 3. ÎÇòÎ®∏ÏßÄ Ï±ÑÏö∞Í∏∞
                fillQuarter(quarterPlayers, currentSlot, isImportantQuarter);
                
                // Ï∂úÏ†Ñ Í∏∞Î°ù ÏóÖÎç∞Ïù¥Ìä∏
                quarterPlayers.forEach(p => {
                    lastPlaySlot[p.number] = currentSlot;
                });
                
                return quarterPlayers;
            }
            
            // Í≤ΩÍ∏∞ ÏàúÏÑúÏóê Îî∞Îùº ÏøºÌÑ∞ ÏÉùÏÑ±
            const results = {
                vsA: { q1: [], q2: [], q3: [], q4: [] },
                vsC: { q1: [], q2: [], q3: [], q4: [] }
            };
            
            // Ï§ëÏöîÎèÑ ÏàúÏÑúÎ°ú ÏÉùÏÑ±ÌïòÎêò, Í≤ΩÍ∏∞ ÏàúÏÑúÏùò Ïä¨Î°Ø Ï†ïÎ≥¥ ÌôúÏö©
            // Î®ºÏ†Ä Ï†ÑÏ≤¥ ÏãúÌÄÄÏä§Î•º Ï§ëÏöîÎèÑ ÏàúÏúºÎ°ú Ï†ïÎ†¨
            const sortedSequence = [...order.sequence].sort((a, b) => {
                const impA = getQuarterImportance(a.quarter);
                const impB = getQuarterImportance(b.quarter);
                return impB - impA; // Ï§ëÏöîÎèÑ ÎÜíÏùÄ Ïàú
            });
            
            // Ï§ëÏöîÎèÑ ÏàúÏÑúÎåÄÎ°ú ÏÉùÏÑ±
            sortedSequence.forEach(item => {
                const isImportant = getQuarterImportance(item.quarter) >= 3; // q3, q4Í∞Ä Ï§ëÏöî
                results[item.match][item.quarter] = createBalancedQuarter(item.slot, isImportant);
            });
            
            entryVsA = results.vsA;
            entryVsC = results.vsC;
            
            renderPlayerList();
            renderEntryCards();
            
            // Ï≤¥Î†• Î∂ÑÏÑù
            analyzeStamina();
            
            showNotification(`üé≤ Ï≤¥Î†• ÏïàÎ∞∞ Ï†ÅÏö© ÏôÑÎ£å! (Í≤ΩÍ∏∞ÏàúÏÑú: ${order.name})`);
        }
        
        // Ï≤¥Î†• Î∂ÑÏÑù Ìï®Ïàò
        function analyzeStamina() {
            const orderNum = document.getElementById('matchOrder').value;
            const order = matchOrders[orderNum];
            
            // ÏÑ†ÏàòÎ≥Ñ Ïó∞ÏÜç Ï∂úÏ†Ñ Ï≤¥ÌÅ¨
            const issues = [];
            
            selectedPlayers.forEach(player => {
                let consecutive = 0;
                let maxConsecutive = 0;
                let lastPlayed = false;
                
                order.sequence.forEach((item, idx) => {
                    const entry = item.match === 'vsA' ? entryVsA : entryVsC;
                    const isPlaying = entry[item.quarter].some(p => p.number === player.number);
                    
                    if (isPlaying) {
                        if (lastPlayed) {
                            consecutive++;
                        } else {
                            consecutive = 1;
                        }
                        maxConsecutive = Math.max(maxConsecutive, consecutive);
                        lastPlayed = true;
                    } else {
                        lastPlayed = false;
                        consecutive = 0;
                    }
                });
                
                if (maxConsecutive >= 4) {
                    issues.push(`‚ö†Ô∏è ${player.name}: ${maxConsecutive}ÏøºÌÑ∞ Ïó∞ÏÜç Ï∂úÏ†Ñ`);
                }
            });
            
            // Î¨∏Ï†úÍ∞Ä ÏûàÏúºÎ©¥ ÌëúÏãú
            if (issues.length > 0) {
                console.log('Ï≤¥Î†• Í≤ΩÍ≥†:', issues);
            }
        }
        
        function renderEntryCards() {
            const container = document.getElementById('entryCards');
            const quarterCounts = getPlayerQuarterCounts();
            
            container.innerHTML = `
                <!-- vs AÌåÄ -->
                <div class="entry-card vs-a">
                    <div class="entry-card-title">üî¥ vs AÌåÄ (Ï±ÑÏòÅÏßÑ) - 1Í≤ΩÍ∏∞</div>
                    <div class="quarters-container">
                        ${renderQuarterRow('vsA', 'q1', '1ÏøºÌÑ∞', entryVsA.q1)}
                        ${renderQuarterRow('vsA', 'q2', '2ÏøºÌÑ∞', entryVsA.q2)}
                        ${renderQuarterRow('vsA', 'q3', '3ÏøºÌÑ∞', entryVsA.q3)}
                        ${renderQuarterRow('vsA', 'q4', '4ÏøºÌÑ∞', entryVsA.q4)}
                    </div>
                </div>
                
                <!-- vs CÌåÄ -->
                <div class="entry-card vs-c">
                    <div class="entry-card-title">üîµ vs CÌåÄ (Ïã¨Ï∞ΩÌòÑ) - 2Í≤ΩÍ∏∞</div>
                    <div class="quarters-container">
                        ${renderQuarterRow('vsC', 'q1', '1ÏøºÌÑ∞', entryVsC.q1)}
                        ${renderQuarterRow('vsC', 'q2', '2ÏøºÌÑ∞', entryVsC.q2)}
                        ${renderQuarterRow('vsC', 'q3', '3ÏøºÌÑ∞', entryVsC.q3)}
                        ${renderQuarterRow('vsC', 'q4', '4ÏøºÌÑ∞', entryVsC.q4)}
                    </div>
                </div>
                
                <!-- ÏÑ†ÏàòÎ≥Ñ Ï∂úÏ†Ñ ÌÜµÍ≥Ñ -->
                <div class="stats-summary">
                    <div class="stats-title">üìä ÏÑ†ÏàòÎ≥Ñ Ï¥ù Ï∂úÏ†Ñ ÏøºÌÑ∞</div>
                    <div class="stats-grid">
                        ${selectedPlayers.map(p => {
                            const count = quarterCounts[p.number] || 0;
                            const countClass = getQuarterCountClass(count);
                            return `
                                <div class="stat-item">
                                    <span class="stat-name">${p.name}</span>
                                    <span class="stat-value ${countClass}">${count}ÏøºÌÑ∞</span>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <!-- Ïö¥ÏòÅÏßÑ Î∞∞Ï†ï -->
                <div class="staff-section">
                    <div class="staff-title">üéΩ Ïö¥ÏòÅÏßÑ Î∞∞Ï†ï</div>
                    <div class="staff-grid">
                        <div class="staff-category">
                            <div class="staff-category-title">‚öñÔ∏è Ïã¨Ìåê</div>
                            <div class="staff-slots">
                                <div class="staff-slot" 
                                     ondrop="handleStaffDrop(event, 'referee_outer')"
                                     ondragover="handleDragOver(event)"
                                     ondragleave="handleDragLeave(event)">
                                    <span class="slot-role">Ïô∏Ï∏°</span>
                                    <span class="slot-player" id="staff_referee_outer">-</span>
                                </div>
                                <div class="staff-slot"
                                     ondrop="handleStaffDrop(event, 'referee_center')"
                                     ondragover="handleDragOver(event)"
                                     ondragleave="handleDragLeave(event)">
                                    <span class="slot-role">Ï§ëÏïô</span>
                                    <span class="slot-player" id="staff_referee_center">-</span>
                                </div>
                                <div class="staff-slot"
                                     ondrop="handleStaffDrop(event, 'referee_inner')"
                                     ondragover="handleDragOver(event)"
                                     ondragleave="handleDragLeave(event)">
                                    <span class="slot-role">ÎÇ¥Ï∏°</span>
                                    <span class="slot-player" id="staff_referee_inner">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="staff-category">
                            <div class="staff-category-title">üìã Í∏∞Î°ù</div>
                            <div class="staff-slots">
                                <div class="staff-slot"
                                     ondrop="handleStaffDrop(event, 'scoreboard')"
                                     ondragover="handleDragOver(event)"
                                     ondragleave="handleDragLeave(event)">
                                    <span class="slot-role">Ï†êÏàòÌåê</span>
                                    <span class="slot-player" id="staff_scoreboard">-</span>
                                </div>
                                <div class="staff-slot"
                                     ondrop="handleStaffDrop(event, 'record')"
                                     ondragover="handleDragOver(event)"
                                     ondragleave="handleDragLeave(event)">
                                    <span class="slot-role">Í∏∞Î°ùÏßÄ</span>
                                    <span class="slot-player" id="staff_record">-</span>
                                </div>
                                <div class="staff-slot"
                                     ondrop="handleStaffDrop(event, 'sub_record')"
                                     ondragover="handleDragOver(event)"
                                     ondragleave="handleDragLeave(event)">
                                    <span class="slot-role">Î∂ÄÍ∞ÄÍ∏∞Î°ù</span>
                                    <span class="slot-player" id="staff_sub_record">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="staff-category">
                            <div class="staff-category-title">üìπ Ï¥¨ÏòÅ</div>
                            <div class="staff-slots">
                                <div class="staff-slot"
                                     ondrop="handleStaffDrop(event, 'camera')"
                                     ondragover="handleDragOver(event)"
                                     ondragleave="handleDragLeave(event)">
                                    <span class="slot-role">Ï¥¨ÏòÅ</span>
                                    <span class="slot-player" id="staff_camera">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="action-btn secondary" onclick="clearStaff()" style="margin-top: 10px;">Ïö¥ÏòÅÏßÑ Ï¥àÍ∏∞Ìôî</button>
                </div>
            `;
            
            // ÎìúÎûòÍ∑∏ Ïù¥Î≤§Ìä∏ Ïó∞Í≤∞
            document.querySelectorAll('.quarter-players').forEach(el => {
                el.addEventListener('dragover', handleDragOver);
                el.addEventListener('dragleave', handleDragLeave);
            });
        }
        
        function renderQuarterRow(match, quarter, title, players) {
            const count = players.length;
            const countClass = count === 5 ? 'ok' : 'warn';
            const boxClass = count === 5 ? 'full' : (count > 5 ? 'over' : '');
            
            const playersHtml = players.map((p, idx) => {
                const isHighlighted = highlightedPlayer === p.number;
                return `
                <div class="entry-player ${isHighlighted ? 'highlighted' : ''}" 
                     draggable="true"
                     ondragstart="handleEntryDragStart(event, '${match}', '${quarter}', ${idx})"
                     ondragend="handleDragEnd(event)"
                     onclick="event.stopPropagation(); toggleHighlight(${p.number})">
                    <div class="num">${p.number}</div>
                    <div class="player-details">
                        <div class="player-name">${p.name}</div>
                        <div class="player-pos">${p.position}</div>
                    </div>
                    <div class="remove-btn" onclick="event.stopPropagation(); removeFromQuarter('${match}', '${quarter}', ${idx})">‚úï</div>
                </div>
            `}).join('');
            
            return `
                <div class="quarter-row">
                    <div class="quarter-label">${title}</div>
                    <div class="quarter-players ${boxClass}" 
                         ondrop="handleDrop(event, '${match}', '${quarter}')"
                         ondragover="handleDragOver(event)"
                         ondragleave="handleDragLeave(event)">
                        ${playersHtml}
                    </div>
                    <div class="quarter-count-display ${countClass}">${count}/5</div>
                </div>
            `;
        }
        
        function clearEntry() {
            entryVsA = { q1: [], q2: [], q3: [], q4: [] };
            entryVsC = { q1: [], q2: [], q3: [], q4: [] };
            
            renderPlayerList();
            
            document.getElementById('entryCards').innerHTML = `
                <div class="empty-state">
                    ÏôºÏ™ΩÏóêÏÑú Ï∞∏ÏÑù ÏÑ†ÏàòÎ•º ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉùÌïòÍ±∞ÎÇò<br>
                    ÎìúÎûòÍ∑∏ÌïòÏó¨ ÏßÅÏ†ë ÏóîÌä∏Î¶¨Ïóê Î∞∞ÏπòÌïòÏÑ∏Ïöî<br><br>
                    "ÏóîÌä∏Î¶¨ ÏûêÎèô ÏÉùÏÑ±" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥<br>
                    Ìè¨ÏßÄÏÖò Î∞∏Îü∞Ïä§Î•º Í≥†Î†§ÌïòÏó¨ ÏûêÎèô Ìé∏ÏÑ±Îê©ÎãàÎã§
                </div>
            `;
            
            document.getElementById('previewSection').style.display = 'none';
            showNotification('ÏóîÌä∏Î¶¨Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§');
        }
        
        function generateShareImage() {
            const round = document.getElementById('roundNumber').value;
            const dutyTeam = document.getElementById('dutyTeam').value;
            const shareCard = document.getElementById('shareCard');
            const quarterCounts = getPlayerQuarterCounts();
            
            // Ïö¥ÏòÅÏßÑ Ï†ïÎ≥¥ ÏÉùÏÑ±
            const staffInfo = Object.keys(staffAssignments)
                .filter(role => staffAssignments[role])
                .map(role => `${staffRoleNames[role]}: ${staffAssignments[role].name}`)
                .join(' | ');
            
            // ÎãπÎ≤àÌåÄ ÌëúÏãú
            const dutyTeamNames = { 'A': 'AÌåÄ (Ï±ÑÏòÅÏßÑ)', 'B': 'BÌåÄ (Ïù¥Ïú§ÏÇº)', 'C': 'CÌåÄ (Ïã¨Ï∞ΩÌòÑ)' };
            const dutyText = dutyTeam ? `ÎãπÎ≤à: ${dutyTeamNames[dutyTeam]}` : '';
            
            // Ïú†ÎãàÌèº ÌëúÏãú
            const uniformText = selectedUniform ? `Ïú†ÎãàÌèº: ${uniformNames[selectedUniform]}` : '';
            const uniformEmoji = selectedUniform === 'white' ? '‚ö™' : selectedUniform === 'red' ? 'üî¥' : selectedUniform === 'black' ? '‚ö´' : '';
            
            shareCard.innerHTML = `
                <div class="share-title">üèÄ ${round}ÎùºÏö¥Îìú BÌåÄ (Ïù¥Ïú§ÏÇº) ÏóîÌä∏Î¶¨</div>
                
                ${(dutyText || uniformText) ? `
                <div class="share-info-bar">
                    ${dutyText ? `<span class="share-info-item">üìã ${dutyText}</span>` : ''}
                    ${uniformText ? `<span class="share-info-item">${uniformEmoji} ${uniformText}</span>` : ''}
                </div>
                ` : ''}
                
                <div class="share-match vs-a">
                    <div class="share-match-title">üî¥ vs AÌåÄ (Ï±ÑÏòÅÏßÑ)</div>
                    ${renderShareQuarters(entryVsA)}
                </div>
                
                <div class="share-match vs-c">
                    <div class="share-match-title">üîµ vs CÌåÄ (Ïã¨Ï∞ΩÌòÑ)</div>
                    ${renderShareQuarters(entryVsC)}
                </div>
                
                <div class="share-stats">
                    <div class="share-stats-title">üìä ÏÑ†ÏàòÎ≥Ñ Ï¥ù Ï∂úÏ†Ñ ÏøºÌÑ∞</div>
                    <div class="share-stats-grid">
                        ${selectedPlayers.map(p => {
                            const count = quarterCounts[p.number] || 0;
                            return `<div class="share-stat-item">${p.name}: ${count}ÏøºÌÑ∞</div>`;
                        }).join('')}
                    </div>
                </div>
                
                ${staffInfo ? `
                <div class="share-stats" style="margin-top: 15px;">
                    <div class="share-stats-title">üéΩ Ïö¥ÏòÅÏßÑ</div>
                    <div class="share-stats-grid">
                        ${Object.keys(staffAssignments)
                            .filter(role => staffAssignments[role])
                            .map(role => `<div class="share-stat-item">${staffRoleNames[role]}: ${staffAssignments[role].name}</div>`)
                            .join('')}
                    </div>
                </div>
                ` : ''}
            `;
            
            // ÎØ∏Î¶¨Î≥¥Í∏∞ ÌëúÏãú
            document.getElementById('previewSection').style.display = 'block';
            
            // Ïä§ÌÅ¨Î°§ Ïù¥Îèô
            document.getElementById('previewSection').scrollIntoView({ behavior: 'smooth' });
            
            // Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Î∞è Îã§Ïö¥Î°úÎìú
            setTimeout(() => {
                html2canvas(shareCard, {
                    backgroundColor: '#1a1a2e',
                    scale: 2
                }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = `BÌåÄ_${round}ÎùºÏö¥Îìú_ÏóîÌä∏Î¶¨.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                    
                    showNotification('Ïù¥ÎØ∏ÏßÄÍ∞Ä Îã§Ïö¥Î°úÎìú Ìè¥ÎçîÏóê Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
                });
            }, 100);
        }
        
        function renderShareQuarters(entry) {
            const quarters = ['q1', 'q2', 'q3', 'q4'];
            const labels = ['1Q', '2Q', '3Q', '4Q'];
            
            return quarters.map((q, i) => `
                <div class="share-quarter-row">
                    <div class="share-quarter-label">${labels[i]}</div>
                    <div class="share-players">
                        ${entry[q].map(p => `
                            <div class="share-player">
                                <div class="num">${p.number}</div>
                                <div class="name">${p.name}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }
        
        function showNotification(message, type = 'success') {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.className = `notification show`;
            
            setTimeout(() => {
                notif.classList.remove('show');
            }, 2500);
        }
        
        // Ï¥àÍ∏∞ Î†åÎçîÎßÅ
        renderPlayerList();
        renderOpponentTeams();
        updateMatchOrderDisplay();
    </script>
</body>
</html>
